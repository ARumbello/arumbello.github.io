<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scaleside TBYB - Page Editor</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #f8fafc;
            color: #1a1a1a;
            line-height: 1.5;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 0 24px;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: #f3f4f6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #6b7280;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .page-info {
            display: flex;
            flex-direction: column;
        }

        .page-title {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 2px;
        }

        .page-subtitle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #6b7280;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #f59e0b;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            transition: all 0.2s;
            border: none;
        }

        .btn-secondary {
            background: white;
            color: #374151;
            border: 1px solid #e5e7eb;
        }

        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
            box-shadow: 0 1px 3px rgba(37, 99, 235, 0.3);
        }

        .btn-primary:hover {
            background: #1d4ed8;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        /* Main Layout */
        .editor-container {
            display: flex;
            height: calc(100vh - 64px);
        }

        /* Left Sidebar */
        .left-sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
        }

        .sidebar-tab {
            flex: 1;
            padding: 12px 16px;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            text-align: center;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }

        .sidebar-tab:hover {
            color: #374151;
            background: #f9fafb;
        }

        .sidebar-tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 12px;
        }

        .element-group {
            margin-bottom: 24px;
        }

        .element-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
        }

        .element-item:hover {
            border-color: #2563eb;
            background: #f8fafc;
        }

        .element-icon {
            width: 32px;
            height: 32px;
            background: #f3f4f6;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .element-info {
            flex: 1;
        }

        .element-name {
            font-size: 13px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 2px;
        }

        .element-desc {
            font-size: 11px;
            color: #6b7280;
        }

        /* Canvas Area */
        .canvas-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f3f4f6;
        }

        .canvas-toolbar {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .device-selector {
            display: flex;
            gap: 8px;
        }

        .device-btn {
            width: 36px;
            height: 36px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #6b7280;
            transition: all 0.2s;
        }

        .device-btn:hover,
        .device-btn.active {
            border-color: #2563eb;
            color: #2563eb;
            background: #f0f9ff;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #6b7280;
            font-size: 14px;
        }

        .zoom-level {
            font-size: 13px;
            color: #6b7280;
            min-width: 50px;
            text-align: center;
        }

        .canvas-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            overflow: auto;
        }

        .canvas {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .canvas.desktop {
            width: 1200px;
            height: 800px;
        }

        .canvas.tablet {
            width: 768px;
            height: 1024px;
        }

        .canvas.mobile {
            width: 375px;
            height: 667px;
        }

        /* Checkout Page Preview */
        .checkout-preview {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            font-family: system-ui, -apple-system, sans-serif;
        }

        .preview-header {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .preview-logo {
            font-size: 24px;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 8px;
        }

        .preview-tagline {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .secure-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .checkout-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            min-height: calc(100% - 80px);
        }

        .form-section {
            padding: 40px;
            background: white;
        }

        .offer-section {
            background: #f8f9fa;
            padding: 40px 30px;
            border-left: 1px solid #e9ecef;
        }

        .offer-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 30px;
        }

        .offer-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .offer-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .trial-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .trial-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .trial-step {
            text-align: center;
            flex: 1;
        }

        .step-icon {
            width: 40px;
            height: 40px;
            background: #e9ecef;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            font-size: 18px;
        }

        .step-text {
            font-size: 11px;
            color: #6b7280;
            font-weight: 600;
        }

        /* Product Selection Area - Editable */
        .product-selection {
            border: 2px dashed #3b82f6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: rgba(59, 130, 246, 0.05);
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .product-selection:hover {
            border-color: #1d4ed8;
            background: rgba(59, 130, 246, 0.1);
        }

        .product-selection.active {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }

        .product-selection::before {
            content: "Product List Component - Click to Manage Products";
            position: absolute;
            top: -12px;
            left: 12px;
            background: #3b82f6;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        .product-selection.active::before {
            content: "Product List Component - Managing Products";
            background: #10b981;
        }

        .bundle-step {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            color: #2563eb;
            font-weight: 600;
            font-size: 14px;
        }

        .product-option {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .product-option:hover {
            border-color: #2563eb;
        }

        .product-option.selected {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .product-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            position: relative;
        }

        .product-option.selected .product-checkbox {
            background: #10b981;
            border-color: #10b981;
        }

        .product-option.selected .product-checkbox::after {
            content: '‚úì';
            position: absolute;
            top: -2px;
            left: 2px;
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        .product-image {
            width: 48px;
            height: 48px;
            background: #f3f4f6;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .product-details {
            flex: 1;
        }

        .product-name {
            font-size: 13px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .product-discount {
            font-size: 11px;
            color: #10b981;
            font-weight: 600;
        }

        .product-price {
            text-align: right;
        }

        .original-price {
            font-size: 11px;
            color: #6b7280;
            text-decoration: line-through;
        }

        .current-price {
            font-size: 14px;
            font-weight: 700;
            color: #111827;
        }

        .form-section h2 {
            font-size: 20px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 8px;
        }

        .form-section p {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 6px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Right Panel - Product Management */
        .right-panel {
            width: 400px;
            background: white;
            border-left: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            position: relative;
            z-index: 200;
        }

        .right-panel.active {
            transform: translateX(0);
        }

        .panel-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 16px;
            font-weight: 700;
            color: #111827;
        }

        .panel-close {
            width: 32px;
            height: 32px;
            border: none;
            background: #f3f4f6;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
        }

        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .products-list {
            margin-bottom: 24px;
        }

        .products-list h3 {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .add-product-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .product-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .product-item:hover {
            border-color: #2563eb;
            background: #f8fafc;
        }

        .product-item.selected {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .product-handle {
            cursor: grab;
            color: #9ca3af;
            font-size: 12px;
        }

        .product-handle:active {
            cursor: grabbing;
        }

        .product-thumb {
            width: 40px;
            height: 40px;
            background: #fbbf24;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .product-info {
            flex: 1;
        }

        .product-info-name {
            font-size: 13px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 2px;
        }

        .product-info-price {
            font-size: 12px;
            color: #059669;
            font-weight: 600;
        }

        .product-actions {
            display: flex;
            gap: 4px;
        }

        .action-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: #f3f4f6;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 12px;
        }

        .action-btn:hover {
            background: #e5e7eb;
        }

        .action-btn.edit {
            color: #dc2626;
        }

        .action-btn.edit:hover {
            color: #dc2626;
            background: #fef2f2;
        }

        .action-btn.delete:hover {
            color: #dc2626;
            background: #fef2f2;
        }

        /* Component Toolbar */
        .component-toolbar {
            position: absolute;
            top: -40px;
            left: 0;
            background: #111827;
            border-radius: 6px;
            padding: 8px;
            display: flex;
            gap: 8px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
            z-index: 300;
        }

        .product-selection:hover .component-toolbar,
        .product-selection.active .component-toolbar {
            opacity: 1;
            visibility: visible;
        }

        .toolbar-btn {
            background: transparent;
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toolbar-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .toolbar-btn.primary {
            background: #2563eb;
        }

        .toolbar-btn.primary:hover {
            background: #1d4ed8;
        }

        /* Product Edit Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border: none;
            background: #f3f4f6;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .modal-section {
            margin-bottom: 32px;
            padding-bottom: 32px;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .modal-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .product-images-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .product-image-item {
            aspect-ratio: 1;
            background: #f3f4f6;
            border: 2px solid transparent;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .product-image-item:hover {
            border-color: #2563eb;
        }

        .product-image-item.selected {
            border-color: #2563eb;
        }

        .product-image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .price-input-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .price-input-wrapper {
            flex: 1;
            position: relative;
        }

        .price-input-prefix {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
        }

        .price-input {
            padding-left: 32px;
        }

        .shopify-price-badge {
            background: #f3f4f6;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toggle-switch {
            width: 44px;
            height: 24px;
            background: #e5e7eb;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toggle-switch.active {
            background: #2563eb;
        }

        .toggle-switch .toggle-slider {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }

        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .toggle-info {
            flex: 1;
        }

        .toggle-label {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .toggle-description {
            font-size: 12px;
            color: #6b7280;
        }

        .trial-settings {
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            display: none;
        }

        .trial-settings.active {
            display: block;
        }

        .subscription-settings {
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            display: none;
        }

        .subscription-settings.active {
            display: block;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f9fafb;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            border: none;
        }

        .modal-btn-secondary {
            background: white;
            color: #374151;
            border: 1px solid #e5e7eb;
        }

        .modal-btn-primary {
            background: #2563eb;
            color: white;
        }

        .form-help {
            font-size: 12px;
            color: #6b7280;
            margin-top: 6px;
        }

        .info-box {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .info-box-content {
            font-size: 12px;
            color: #0369a1;
            line-height: 1.5;
        }

        /* Settings Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Pricing Type Cards */
        .pricing-type-card {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .pricing-type-card:hover {
            border-color: #2563eb;
            background: #f0f9ff;
        }

        .pricing-type-card.active {
            border-color: #2563eb;
            background: #f0f9ff;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .pricing-type-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .pricing-type-name {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .pricing-type-desc {
            font-size: 11px;
            color: #6b7280;
        }

        /* Pricing Timeline */
        .pricing-timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline-item {
            position: relative;
            padding-bottom: 32px;
        }

        .timeline-item:last-child {
            padding-bottom: 0;
        }

        .timeline-dot {
            position: absolute;
            left: -32px;
            top: 8px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #e5e7eb;
            border: 3px solid white;
            box-shadow: 0 0 0 1px #e5e7eb;
        }

        .timeline-dot.active {
            background: #2563eb;
            box-shadow: 0 0 0 1px #2563eb;
        }

        .timeline-dot.warning {
            background: #f59e0b;
            box-shadow: 0 0 0 1px #f59e0b;
        }

        .timeline-connector {
            position: absolute;
            left: -24px;
            top: 32px;
            width: 2px;
            height: calc(100% - 32px);
            background: #e5e7eb;
        }

        .timeline-content {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
        }

        .timeline-label {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 12px;
        }

        .timeline-desc {
            font-size: 12px;
            color: #6b7280;
            margin-top: 8px;
        }

        .subscription-frequency {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            font-size: 13px;
            color: #6b7280;
        }

        .inline-input, .inline-select {
            display: inline-block;
            padding: 6px 8px;
            font-size: 13px;
        }

        .trial-duration-input {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #6b7280;
        }

        .subscription-after-trial {
            margin-top: 12px;
            padding: 12px;
            background: #f3f4f6;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="back-btn" onclick="goBack()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <div class="page-info">
                <div class="page-title">Editing: Checkout Page</div>
                <div class="page-subtitle">
                    <div class="status-dot"></div>
                    <span>Visual Editor ‚Ä¢ Auto-saved</span>
                </div>
            </div>
        </div>
        
        <div class="header-actions">
            <button class="header-btn btn-secondary" onclick="previewPage()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                </svg>
                Preview
            </button>
            <button class="header-btn btn-primary" onclick="saveAndExit()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"/>
                </svg>
                Save & Exit
            </button>
        </div>
    </header>

    <!-- Main Editor Container -->
    <div class="editor-container">
        <!-- Left Sidebar -->
        <div class="left-sidebar">
            <div class="sidebar-tabs">
                <div class="sidebar-tab active" data-tab="elements">Elements</div>
                <div class="sidebar-tab" data-tab="settings">Settings</div>
            </div>
            
            <div class="sidebar-content">
                <div class="tab-content active" id="elements-tab">
                    <div class="element-group">
                        <div class="section-title">Layout</div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üìÑ</div>
                            <div class="element-info">
                                <div class="element-name">Section</div>
                                <div class="element-desc">Container section</div>
                            </div>
                        </div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">‚öè</div>
                            <div class="element-info">
                                <div class="element-name">Columns</div>
                                <div class="element-desc">Multi-column layout</div>
                            </div>
                        </div>
                    </div>

                    <div class="element-group">
                        <div class="section-title">Content</div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üõçÔ∏è</div>
                            <div class="element-info">
                                <div class="element-name">Product List</div>
                                <div class="element-desc">Product selection</div>
                            </div>
                        </div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üìù</div>
                            <div class="element-info">
                                <div class="element-name">Form</div>
                                <div class="element-desc">Contact/shipping form</div>
                            </div>
                        </div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üéØ</div>
                            <div class="element-info">
                                <div class="element-name">CTA Button</div>
                                <div class="element-desc">Call to action</div>
                            </div>
                        </div>
                    </div>

                    <div class="element-group">
                        <div class="section-title">Media</div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üñºÔ∏è</div>
                            <div class="element-info">
                                <div class="element-name">Image</div>
                                <div class="element-desc">Single image</div>
                            </div>
                        </div>
                        <div class="element-item" draggable="true">
                            <div class="element-icon">üé•</div>
                            <div class="element-info">
                                <div class="element-name">Video</div>
                                <div class="element-desc">Video player</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="settings-tab" style="display: none;">
                    <div class="element-group">
                        <div class="section-title">Page Information</div>
                        <div class="form-group">
                            <label class="form-label">Page Title</label>
                            <input type="text" class="form-input" value="Secure Checkout" onchange="triggerAutoSave()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Page URL Path</label>
                            <input type="text" class="form-input" value="/checkout" onchange="triggerAutoSave()">
                            <div class="form-help">Custom URL path for this page</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Page Type</label>
                            <select class="form-input" onchange="triggerAutoSave()">
                                <option value="checkout" selected>Checkout Page</option>
                                <option value="landing">Landing Page</option>
                                <option value="upsell">Upsell Page</option>
                                <option value="downsell">Downsell Page</option>
                                <option value="thankyou">Thank You Page</option>
                                <option value="custom">Custom Page</option>
                            </select>
                        </div>
                    </div>

                    <div class="element-group">
                        <div class="section-title">SEO & Meta Tags</div>
                        <div class="form-group">
                            <label class="form-label">Meta Title</label>
                            <input type="text" class="form-input" value="Complete Your Order - Try Before You Buy" onchange="triggerAutoSave()">
                            <div class="form-help">Title shown in search results and browser tabs</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Meta Description</label>
                            <textarea class="form-input" rows="3" onchange="triggerAutoSave()">Complete your order securely with our Try Before You Buy program. 14-day trial, only pay shipping today.</textarea>
                            <div class="form-help">Description for search engines (150-160 chars)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Canvas Area -->
        <div class="canvas-area">
            <div class="canvas-toolbar">
                <div class="device-selector">
                    <button class="device-btn active" data-device="desktop" title="Desktop">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                            <line x1="8" y1="21" x2="16" y2="21"/>
                            <line x1="12" y1="17" x2="12" y2="21"/>
                        </svg>
                    </button>
                    <button class="device-btn" data-device="tablet" title="Tablet">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>
                            <line x1="12" y1="18" x2="12.01" y2="18"/>
                        </svg>
                    </button>
                    <button class="device-btn" data-device="mobile" title="Mobile">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
                            <line x1="12" y1="18" x2="12.01" y2="18"/>
                        </svg>
                    </button>
                </div>
                
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomOut()">‚àí</button>
                    <div class="zoom-level">100%</div>
                    <button class="zoom-btn" onclick="zoomIn()">+</button>
                </div>
            </div>

            <div class="canvas-wrapper">
                <div class="canvas desktop" id="pageCanvas">
                    <div class="checkout-preview">
                        <div class="preview-header">
                            <div class="preview-logo">MA√ãLYS</div>
                            <div class="preview-tagline">clinically proven body solutions</div>
                            <div class="secure-badge">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                    <circle cx="12" cy="7" r="4"/>
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                </svg>
                                SECURE CHECKOUT
                            </div>
                        </div>

                        <div class="checkout-content">
                            <div class="form-section">
                                <div class="offer-header">
                                    <div class="offer-title">TRY BEFORE YOU BUY</div>
                                    <div class="offer-subtitle">Try it at home for 3 weeks, pay only if you love it!</div>
                                </div>

                                <div class="trial-info">
                                    <h3 style="font-size: 16px; margin-bottom: 16px; color: #111827;">How Does Try Before You Buy Work?</h3>
                                    
                                    <div class="trial-steps">
                                        <div class="trial-step">
                                            <div class="step-icon">üì¶</div>
                                            <div class="step-text">Order & Pay Only Shipping Today</div>
                                        </div>
                                        <div class="trial-step">
                                            <div class="step-icon">‚ù§Ô∏è</div>
                                            <div class="step-text">Love It? Keep It! (30-Good Price)</div>
                                        </div>
                                        <div class="trial-step">
                                            <div class="step-icon">üîÑ</div>
                                            <div class="step-text">Full Refund (30-Good Promise)</div>
                                        </div>
                                    </div>

                                    <div style="background: #f8f9fa; padding: 16px; border-radius: 6px; margin-bottom: 16px;">
                                        <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.4;">
                                            <strong>‚úì</strong> Try any product at home for 3 weeks, just pay for shipping! We may pre-authorize your card for the full amount for fraud protection.
                                        </p>
                                    </div>
                                    
                                    <div style="background: #f8f9fa; padding: 16px; border-radius: 6px; margin-bottom: 16px;">
                                        <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.4;">
                                            <strong>üíö</strong> We know you're gonna LOVE the product(s), but if you don't - no worries! You can return a product even if it's been opened.
                                        </p>
                                    </div>
                                    
                                    <div style="background: #f8f9fa; padding: 16px; border-radius: 6px;">
                                        <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.4;">
                                            <strong>‚ù§Ô∏è</strong> Love it? Great! You'll only be charged <strong>$108.00</strong> at the end of your 3-week trial. Not a perfect fit? Return it for FREE before the trial ends & you won't be charged.
                                        </p>
                                    </div>
                                </div>

                                <!-- Product Selection Component - Editable -->
                                <div class="product-selection" onclick="openProductManager()">
                                    <div class="component-toolbar">
                                        <button class="toolbar-btn primary" onclick="openProductManager()">Manage Products</button>
                                        <button class="toolbar-btn">Settings</button>
                                        <button class="toolbar-btn">Duplicate</button>
                                        <button class="toolbar-btn">Delete</button>
                                    </div>
                                    
                                    <div class="bundle-step">
                                        <div class="step-header">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                                <line x1="16" y1="2" x2="16" y2="6"/>
                                                <line x1="8" y1="2" x2="8" y2="6"/>
                                                <line x1="3" y1="10" x2="21" y2="10"/>
                                            </svg>
                                            STEP 1: PICK YOUR BUNDLE DISCOUNT
                                        </div>

                                        <div class="product-option selected">
                                            <div class="product-checkbox"></div>
                                            <div class="product-image">üß¥</div>
                                            <div class="product-details">
                                                <div class="product-name">1x Corrective Therapy Device Kit & Buy 1 Get 1 Free Pack Of Electrodes</div>
                                                <div class="product-discount">52% OFF</div>
                                            </div>
                                            <div class="product-price">
                                                <div class="original-price">$497</div>
                                                <div class="current-price">$239.95</div>
                                                <div style="font-size: 10px; color: #6b7280;">+ FREE SHIPPING</div>
                                            </div>
                                        </div>

                                        <div class="product-option">
                                            <div class="product-checkbox"></div>
                                            <div class="product-image">üß¥</div>
                                            <div class="product-details">
                                                <div class="product-name">1x Corrective Therapy Device Kit</div>
                                                <div class="product-discount">50% OFF</div>
                                            </div>
                                            <div class="product-price">
                                                <div class="original-price">$399</div>
                                                <div class="current-price">$199.95</div>
                                                <div style="font-size: 10px; color: #6b7280;">+ FREE SHIPPING</div>
                                            </div>
                                        </div>

                                        <div class="product-option">
                                            <div class="product-checkbox"></div>
                                            <div class="product-image">üß¥</div>
                                            <div class="product-details">
                                                <div class="product-name">2x Corrective Therapy Device Kits & 2 Free Packs Of Electrode Pads</div>
                                                <div class="product-discount">60% OFF</div>
                                            </div>
                                            <div class="product-price">
                                                <div class="original-price">$897</div>
                                                <div class="current-price">$359.95</div>
                                                <div style="font-size: 10px; color: #6b7280;">+ FREE SHIPPING</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div style="background: #f0fdf4; border: 1px dashed #22c55e; border-radius: 6px; padding: 16px; margin-top: 16px;">
                                        <div style="display: flex; align-items: center; gap: 8px; color: #15803d; font-size: 13px; font-weight: 600;">
                                            <span>üì¶</span>
                                            Yes, I want Expedited Shipping for ONLY $9.95!
                                        </div>
                                        <p style="font-size: 11px; color: #15803d; margin: 8px 0 0 24px; line-height: 1.3;">
                                            EXPEDITED SHIPPING: Want express shipping with your order? Select the Expedited Shipping option for just $9.95.
                                        </p>
                                    </div>
                                </div>

                                <h2>Shipping Info</h2>
                                <p>Complete your shipping details below</p>

                                <form>
                                    <div class="form-group">
                                        <label class="form-label">Email*</label>
                                        <input type="email" class="form-input" placeholder="Enter your email">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Country</label>
                                        <select class="form-input">
                                            <option>United States of America</option>
                                            <option>Canada</option>
                                            <option>United Kingdom</option>
                                        </select>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">First Name*</label>
                                            <input type="text" class="form-input" placeholder="First Name">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Last Name*</label>
                                            <input type="text" class="form-input" placeholder="Last Name">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Street Address*</label>
                                        <input type="text" class="form-input" placeholder="Street Address">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Apt #, Suite, Floor, etc.</label>
                                        <input type="text" class="form-input" placeholder="Apt #, Suite, Floor, etc.">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">City*</label>
                                        <input type="text" class="form-input" placeholder="City">
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">State</label>
                                            <select class="form-input">
                                                <option>State</option>
                                                <option>California</option>
                                                <option>New York</option>
                                                <option>Texas</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Zip Code*</label>
                                            <input type="text" class="form-input" placeholder="Zip Code">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Phone*</label>
                                        <input type="tel" class="form-input" placeholder="Phone">
                                    </div>

                                    <div style="margin: 20px 0;">
                                        <label style="display: flex; align-items: center; gap: 8px; font-size: 12px; color: #6b7280;">
                                            <input type="checkbox" style="margin: 0;">
                                            Text me with news and offers
                                        </label>
                                        <p style="font-size: 10px; color: #9ca3af; margin-top: 8px; line-height: 1.3;">
                                            By checking this box you agree to receive informational (e.g., shipping updates) and/or automatic marketing texts (e.g., cart reminders) from MA√ãLYS Cosmetics at the number provided. Consent is not a condition of purchase. Msg frequency varies. Reply STOP to cancel.
                                        </p>
                                    </div>

                                    <button type="button" style="width: 100%; background: #000; color: white; padding: 16px; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px;" onclick="proceedToPayment()">
                                        CONTINUE TO FINAL STEP
                                    </button>
                                </form>
                            </div>

                            <div class="offer-section">
                                <div style="background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; border: 1px solid #e9ecef;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                        <div style="background: #fbbf24; color: white; padding: 6px 8px; border-radius: 4px; font-size: 10px; font-weight: 600;">TRY BEFORE YOU BUY</div>
                                        <div style="font-size: 12px; color: #6b7280;">GET DREAMY Toning Whip</div>
                                        <div style="margin-left: auto; font-size: 14px; font-weight: 600;">$0</div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                        <div style="background: #10b981; color: white; padding: 6px 8px; border-radius: 4px; font-size: 10px; font-weight: 600;">TRY BEFORE YOU BUY</div>
                                        <div style="font-size: 12px; color: #6b7280;">BE VAMP Plumping Body Serum</div>
                                        <div style="margin-left: auto; font-size: 14px; font-weight: 600;">$0</div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                                        <div style="background: #f3f4f6; color: #6b7280; padding: 6px 8px; border-radius: 4px; font-size: 10px; font-weight: 600;">FREE MYSTERY GIFT</div>
                                        <div style="font-size: 12px; color: #6b7280;">Full-size product with your Try Before You Buy order</div>
                                    </div>
                                    
                                    <hr style="border: none; border-top: 1px solid #e9ecef; margin: 16px 0;">
                                    
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; color: #6b7280;">Subtotal</span>
                                        <span style="font-size: 14px; font-weight: 600;">$0</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                                        <span style="font-size: 14px; color: #6b7280;">Shipping</span>
                                        <span style="font-size: 14px; font-weight: 600;">$5.90</span>
                                    </div>
                                    
                                    <hr style="border: none; border-top: 2px solid #111827; margin: 16px 0;">
                                    
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                                        <span style="font-size: 16px; font-weight: 700;">Due Now</span>
                                        <span style="font-size: 16px; font-weight: 700;">$5.90</span>
                                    </div>
                                    
                                    <p style="font-size: 10px; color: #6b7280; text-align: center; margin-bottom: 16px;">
                                        If you're loving the product(s), keep them! We'll charge $108.00 (TBYB) at the end of your 3-week trial period.
                                    </p>
                                    
                                    <div style="background: #f8f9fa; border-radius: 6px; padding: 16px; text-align: center;">
                                        <div style="font-size: 32px; margin-bottom: 8px;">üéÅ</div>
                                        <div style="font-size: 24px; font-weight: 700; margin-bottom: 8px;">0:0:0</div>
                                        <p style="font-size: 11px; color: #6b7280; margin: 0;">
                                            You're getting a mystery item with your order! Don't miss it!
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Product Management -->
        <div class="right-panel" id="productPanel">
            <div class="panel-header">
                <div class="panel-title">Your step products</div>
                <button class="panel-close" onclick="closeProductManager()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            
            <div class="panel-content">
                <div class="products-list">
                    <h3>
                        Active Products
                        <button class="add-product-btn" onclick="addNewProduct()">Add a new product</button>
                    </h3>
                    
                    <div class="product-item selected">
                        <div class="product-handle">‚ãÆ‚ãÆ</div>
                        <div class="product-thumb">OB</div>
                        <div class="product-info">
                            <div class="product-info-name">Expedited-Shipping</div>
                            <div class="product-info-price">$ 9.95</div>
                            <div style="font-size: 10px; color: #6b7280;">One-time</div>
                        </div>
                        <div class="product-actions">
                            <button class="action-btn edit" onclick="editProduct('expedited-shipping')">‚úèÔ∏è</button>
                            <button class="action-btn delete" onclick="deleteProduct('expedited-shipping')">üóëÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="product-item selected">
                        <div class="product-handle">‚ãÆ‚ãÆ</div>
                        <div class="product-thumb">OB</div>
                        <div class="product-info">
                            <div class="product-info-name">2-Years-Protection</div>
                            <div class="product-info-price">$ 19.95</div>
                            <div style="font-size: 10px; color: #6b7280;">One-time</div>
                        </div>
                        <div class="product-actions">
                            <button class="action-btn edit" onclick="editProduct('2-years-protection')">‚úèÔ∏è</button>
                            <button class="action-btn delete" onclick="deleteProduct('2-years-protection')">üóëÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="product-item selected">
                        <div class="product-handle">‚ãÆ‚ãÆ</div>
                        <div class="product-thumb">#1</div>
                        <div class="product-info">
                            <div class="product-info-name">1x Corrective Therapy Device Kit & Buy 1 Get 1 Free Pack Of Electrodes</div>
                            <div class="product-info-price">$ 239.99</div>
                            <div style="font-size: 10px; color: #6b7280;">One-time</div>
                        </div>
                        <div class="product-actions">
                            <button class="action-btn edit" onclick="editProduct('therapy-device-kit-bogo')">‚úèÔ∏è</button>
                            <button class="action-btn delete" onclick="deleteProduct('therapy-device-kit-bogo')">üóëÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="product-item selected">
                        <div class="product-handle">‚ãÆ‚ãÆ</div>
                        <div class="product-thumb">#2</div>
                        <div class="product-info">
                            <div class="product-info-name">1x Corrective Therapy Device Kit</div>
                            <div class="product-info-price">$ 199.99</div>
                            <div style="font-size: 10px; color: #6b7280;">One-time</div>
                        </div>
                        <div class="product-actions">
                            <button class="action-btn edit" onclick="editProduct('therapy-device-kit')">‚úèÔ∏è</button>
                            <button class="action-btn delete" onclick="deleteProduct('therapy-device-kit')">üóëÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="product-item selected">
                        <div class="product-handle">‚ãÆ‚ãÆ</div>
                        <div class="product-thumb">#3</div>
                        <div class="product-info">
                            <div class="product-info-name">2x Corrective Therapy Device Kits & 2 Free Packs Of Electrode Pads</div>
                            <div class="product-info-price">$ 359.95</div>
                            <div style="font-size: 10px; color: #6b7280;">One-time</div>
                        </div>
                        <div class="product-actions">
                            <button class="action-btn edit" onclick="editProduct('therapy-device-kits-2pack')">‚úèÔ∏è</button>
                            <button class="action-btn delete" onclick="deleteProduct('therapy-device-kits-2pack')">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
                
                <div style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 16px; margin-top: 20px;">
                    <div style="font-size: 14px; font-weight: 600; color: #0369a1; margin-bottom: 8px;">
                        üí° Product Management Tips
                    </div>
                    <div style="font-size: 12px; color: #0369a1; line-height: 1.4;">
                        ‚Ä¢ Drag products to reorder them<br>
                        ‚Ä¢ Click edit to modify pricing and details<br>
                        ‚Ä¢ Use the checkboxes to include/exclude products<br>
                        ‚Ä¢ Selected products appear in the step component
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Edit Modal -->
    <div class="modal-overlay" id="productEditModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">1x MyImmunity Balance</div>
                <button class="modal-close" onclick="closeProductEditModal()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- Product Name Section -->
                <div class="modal-section">
                    <div class="modal-section-title">
                        Product name *
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-input" id="productDisplayName" value="1x MyImmunity Balance">
                    </div>
                </div>

                <!-- Order Type Section -->
                <div class="modal-section">
                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Is this an order bump?</div>
                        </div>
                        <div class="toggle-switch" id="order-bump-toggle">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <!-- Pricing Model Section -->
                <div class="modal-section">
                    <div class="modal-section-title">
                        üí∞ Pricing Model
                    </div>
                    
                    <!-- Pricing Type Selector -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 24px;">
                        <div class="pricing-type-card active" data-type="one-time" onclick="selectPricingType('one-time')">
                            <div class="pricing-type-icon">üõí</div>
                            <div class="pricing-type-name">One-Time</div>
                            <div class="pricing-type-desc">Single payment</div>
                        </div>
                        <div class="pricing-type-card" data-type="subscription" onclick="selectPricingType('subscription')">
                            <div class="pricing-type-icon">üîÑ</div>
                            <div class="pricing-type-name">Subscription</div>
                            <div class="pricing-type-desc">Recurring billing</div>
                        </div>
                        <div class="pricing-type-card" data-type="trial" onclick="selectPricingType('trial')">
                            <div class="pricing-type-icon">üéØ</div>
                            <div class="pricing-type-name">Try Before Buy</div>
                            <div class="pricing-type-desc">Trial then charge</div>
                        </div>
                    </div>

                    <!-- One-Time Pricing -->
                    <div class="pricing-config active" id="one-time-pricing">
                        <div class="pricing-timeline">
                            <div class="timeline-item">
                                <div class="timeline-dot active"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">Today</div>
                                    <div class="price-input-wrapper">
                                        <span class="price-input-prefix">$</span>
                                        <input type="text" class="form-input price-input" value="239.95">
                                    </div>
                                    <div class="timeline-desc">Customer pays once</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Subscription Pricing -->
                    <div class="pricing-config" id="subscription-pricing" style="display: none;">
                        <div class="pricing-timeline">
                            <div class="timeline-item">
                                <div class="timeline-dot active"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">Today (First Payment)</div>
                                    <div class="price-input-wrapper">
                                        <span class="price-input-prefix">$</span>
                                        <input type="text" class="form-input price-input" value="199.95">
                                    </div>
                                    <div class="timeline-desc">Immediate charge</div>
                                </div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-item">
                                <div class="timeline-dot"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">Recurring Payments</div>
                                    <div class="price-input-wrapper">
                                        <span class="price-input-prefix">$</span>
                                        <input type="text" class="form-input price-input" value="199.95">
                                    </div>
                                    <div class="subscription-frequency">
                                        <span>Every</span>
                                        <input type="number" class="form-input inline-input" value="30" style="width: 60px;">
                                        <select class="form-input inline-select" style="width: 80px;">
                                            <option>days</option>
                                            <option>weeks</option>
                                            <option selected>months</option>
                                            <option>years</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #f0f9ff; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <div style="font-size: 13px; color: #0369a1;">
                                <strong>üìÖ Billing Schedule:</strong><br>
                                ‚Ä¢ First charge: Today ($199.95)<br>
                                ‚Ä¢ Next charge: 30 days from today ($199.95)<br>
                                ‚Ä¢ Continues monthly until cancelled
                            </div>
                        </div>
                    </div>

                    <!-- Try Before You Buy Pricing -->
                    <div class="pricing-config" id="trial-pricing" style="display: none;">
                        <div class="pricing-timeline">
                            <div class="timeline-item">
                                <div class="timeline-dot active"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">Today (Trial Start)</div>
                                    <div class="price-input-wrapper">
                                        <span class="price-input-prefix">$</span>
                                        <input type="text" class="form-input price-input" value="0.00">
                                    </div>
                                    <div class="timeline-desc">Shipping only or $0</div>
                                </div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-item">
                                <div class="timeline-dot warning"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">End of Trial</div>
                                    <div class="trial-duration-input">
                                        <span>After</span>
                                        <input type="number" class="form-input inline-input" value="14" style="width: 60px;">
                                        <span>days</span>
                                    </div>
                                    <div class="price-input-wrapper">
                                        <span class="price-input-prefix">$</span>
                                        <input type="text" class="form-input price-input" value="239.95">
                                    </div>
                                    <div class="timeline-desc">Full price charged if not returned</div>
                                </div>
                            </div>
                            <div class="timeline-connector"></div>
                            <div class="timeline-item">
                                <div class="timeline-dot"></div>
                                <div class="timeline-content">
                                    <div class="timeline-label">Subscribe After Trial?</div>
                                    <div class="toggle-switch" id="post-trial-subscription">
                                        <div class="toggle-slider"></div>
                                    </div>
                                    <div class="subscription-after-trial" style="display: none;">
                                        <div class="price-input-wrapper">
                                            <span class="price-input-prefix">$</span>
                                            <input type="text" class="form-input price-input" value="199.95">
                                        </div>
                                        <div class="subscription-frequency">
                                            <span>Every</span>
                                            <input type="number" class="form-input inline-input" value="30" style="width: 60px;">
                                            <select class="form-input inline-select" style="width: 80px;">
                                                <option>days</option>
                                                <option>weeks</option>
                                                <option selected>months</option>
                                                <option>years</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #fef3c7; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <div style="font-size: 13px; color: #92400e;">
                                <strong>‚è∞ Customer Timeline:</strong><br>
                                ‚Ä¢ Day 0: Pay $0.00 (shipping only)<br>
                                ‚Ä¢ Day 14: Charged $239.95 if product kept<br>
                                ‚Ä¢ Day 44: First subscription charge $199.95 (if enabled)
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Image Section -->
                <div class="modal-section">
                    <div class="modal-section-title">Product image</div>
                    <div class="product-images-grid">
                        <div class="product-image-item selected">
                            <img src="data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3C/svg%3E" alt="Product">
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="modal-section">
                    <div class="modal-section-title">Settings</div>
                    
                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Select by default</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Hide from products list</div>
                        </div>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Highlight</div>
                        </div>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeProductEditModal()">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="saveProductChanges()">Save changes</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize the editor
        document.addEventListener('DOMContentLoaded', function() {
            initializeEditor();
            console.log('Page Editor initialized! üé®');
        });

        let isProductManagerOpen = false;
        let currentEditingProduct = null;

        function initializeEditor() {
            // Initialize sidebar tabs
            const sidebarTabs = document.querySelectorAll('.sidebar-tab');
            const tabContents = document.querySelectorAll('.tab-content');

            sidebarTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    sidebarTabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        content.style.display = 'none';
                    });
                    
                    this.classList.add('active');
                    const tabId = this.dataset.tab + '-tab';
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                        targetContent.style.display = 'block';
                    }
                });
            });

            // Initialize toggle switches
            const toggleSwitches = document.querySelectorAll('.toggle-switch');
            toggleSwitches.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    
                    // Handle trial toggle
                    if (this.id === 'trial-toggle') {
                        const trialSettings = document.querySelector('.trial-settings');
                        if (this.classList.contains('active')) {
                            trialSettings.classList.add('active');
                        } else {
                            trialSettings.classList.remove('active');
                        }
                    }
                    
                    triggerAutoSave();
                });
            });

            // Initialize device selector
            const deviceBtns = document.querySelectorAll('.device-btn');
            const canvas = document.getElementById('pageCanvas');

            deviceBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    deviceBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const device = this.dataset.device;
                    canvas.className = `canvas ${device}`;
                });
            });

            // Initialize product options
            const productOptions = document.querySelectorAll('.product-option');
            productOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    this.classList.toggle('selected');
                });
            });

            // Initialize pricing type selector
            const pricingCards = document.querySelectorAll('.pricing-type-card');
            pricingCards.forEach(card => {
                card.addEventListener('click', function() {
                    const type = this.dataset.type;
                    selectPricingType(type);
                });
            });

            // Initialize post-trial subscription toggle
            const postTrialToggle = document.getElementById('post-trial-subscription');
            if (postTrialToggle) {
                postTrialToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const subscriptionConfig = document.querySelector('.subscription-after-trial');
                    if (this.classList.contains('active')) {
                        subscriptionConfig.style.display = 'block';
                    } else {
                        subscriptionConfig.style.display = 'none';
                    }
                });
            }

            // Make elements draggable
            const elementItems = document.querySelectorAll('.element-item');
            elementItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', this.querySelector('.element-name').textContent);
                });
            });

            // Make canvas droppable
            const canvasWrapper = document.querySelector('.canvas-wrapper');
            canvasWrapper.addEventListener('dragover', function(e) {
                e.preventDefault();
            });

            canvasWrapper.addEventListener('drop', function(e) {
                e.preventDefault();
                const elementType = e.dataTransfer.getData('text/plain');
                console.log('Dropped element:', elementType);
                alert(`Added ${elementType} element to the page!`);
            });
        }

        // Product Manager Functions
        function openProductManager() {
            event.stopPropagation();
            const panel = document.getElementById('productPanel');
            const productSelection = document.querySelector('.product-selection');
            
            panel.classList.add('active');
            productSelection.classList.add('active');
            isProductManagerOpen = true;
            
            console.log('Product manager opened');
        }

        function closeProductManager() {
            const panel = document.getElementById('productPanel');
            const productSelection = document.querySelector('.product-selection');
            
            panel.classList.remove('active');
            productSelection.classList.remove('active');
            isProductManagerOpen = false;
            
            console.log('Product manager closed');
        }

        function addNewProduct() {
            console.log('Adding new product...');
            alert('Product Library Modal would open here.\n\nFeatures:\n‚Ä¢ Browse product catalog\n‚Ä¢ Search and filter products\n‚Ä¢ Drag & drop to add\n‚Ä¢ Set pricing and variants\n‚Ä¢ Configure display options');
        }

        // Product Edit Modal Functions
        function editProduct(productId) {
            event.stopPropagation();
            currentEditingProduct = productId;
            
            const modal = document.getElementById('productEditModal');
            modal.classList.add('active');
            
            console.log('Editing product:', productId);
        }

        function closeProductEditModal() {
            const modal = document.getElementById('productEditModal');
            modal.classList.remove('active');
            currentEditingProduct = null;
        }

        function saveProductChanges() {
            console.log('Saving product changes...');
            
            // Show success message
            const saveBtn = document.querySelector('.modal-btn-primary');
            const originalText = saveBtn.textContent;
            saveBtn.textContent = 'Saved!';
            saveBtn.style.background = '#10b981';
            
            setTimeout(() => {
                saveBtn.textContent = originalText;
                saveBtn.style.background = '';
                closeProductEditModal();
            }, 1000);
        }

        function deleteProduct(productId) {
            if (confirm(`Remove ${productId} from this step?`)) {
                console.log('Deleted product:', productId);
                event.target.closest('.product-item').remove();
            }
        }

        // Header Actions
        function goBack() {
            if (confirm('Are you sure you want to leave the editor? Any unsaved changes will be lost.')) {
                console.log('Navigate back to funnel builder');
                window.history.back();
            }
        }

        function previewPage() {
            console.log('Opening page preview...');
            window.open('/offer/back-pain-relief-trial/checkout?preview=1', '_blank');
        }

        function saveAndExit() {
            const saveBtn = document.querySelector('.btn-primary');
            
            console.log('Saving page changes...');
            
            const originalContent = saveBtn.innerHTML;
            saveBtn.innerHTML = `
                <div style="width: 16px; height: 16px; border: 2px solid #ffffff; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                Saving...
            `;
            saveBtn.disabled = true;
            
            setTimeout(() => {
                saveBtn.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20,6 9,17 4,12"/>
                    </svg>
                    Saved!
                `;
                
                setTimeout(() => {
                    window.history.back();
                }, 1000);
            }, 1500);
        }

        // Zoom Controls
        let currentZoom = 100;

        function zoomIn() {
            if (currentZoom < 200) {
                currentZoom += 25;
                updateZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > 50) {
                currentZoom -= 25;
                updateZoom();
            }
        }

        function updateZoom() {
            const canvas = document.getElementById('pageCanvas');
            const zoomLevel = document.querySelector('.zoom-level');
            
            canvas.style.transform = `scale(${currentZoom / 100})`;
            zoomLevel.textContent = `${currentZoom}%`;
        }

        // Form Interaction
        function proceedToPayment() {
            console.log('Proceeding to payment step...');
            alert('This would proceed to the payment step of the checkout process.');
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (document.getElementById('productEditModal').classList.contains('active')) {
                    closeProductEditModal();
                } else if (isProductManagerOpen) {
                    closeProductManager();
                }
            }
            
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveAndExit();
            }
            
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                previewPage();
            }
        });

        // Auto-save functionality
        let autoSaveTimer;
        function triggerAutoSave() {
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                console.log('Auto-saving changes...');
                document.querySelector('.page-subtitle span').textContent = 'Visual Editor ‚Ä¢ Auto-saved just now';
            }, 2000);
        }

        // Listen for any changes in the editor
        document.addEventListener('input', triggerAutoSave);
        document.addEventListener('click', function(e) {
            if (e.target.closest('.product-option') || e.target.closest('.form-input')) {
                triggerAutoSave();
            }
        });

        // Pricing type selector
        function selectPricingType(type) {
            // Update active card
            document.querySelectorAll('.pricing-type-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            
            // Hide all pricing configs
            document.querySelectorAll('.pricing-config').forEach(config => {
                config.style.display = 'none';
            });
            
            // Show selected pricing config
            document.getElementById(`${type}-pricing`).style.display = 'block';
        }

        // Add animation class for spinning
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
